<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contractor Application - GetContractorNow</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f3f4f6;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
      color: white;
      padding: 40px;
      text-align: center;
    }

    .header h1 {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .form-container {
      padding: 40px;
    }

    .section {
      margin-bottom: 40px;
    }

    .section-title {
      font-size: 1.5rem;
      color: #1f2937;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e5e7eb;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #374151;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .required {
      color: #dc2626;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #2563eb;
    }

    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }

    .form-group small {
      display: block;
      margin-top: 5px;
      color: #6b7280;
      font-size: 0.85rem;
    }

    .checkbox-group {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .checkbox-item input[type="checkbox"] {
      width: auto;
      margin: 0;
    }

    .submit-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .alert-success {
      background: #d1fae5;
      border: 1px solid #10b981;
      color: #065f46;
    }

    .alert-error {
      background: #fee2e2;
      border: 1px solid #ef4444;
      color: #991b1b;
    }

    .spinner {
      display: none;
      border: 4px solid #f3f4f6;
      border-top: 4px solid #2563eb;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }

      .form-container {
        padding: 20px;
      }

      .header {
        padding: 30px 20px;
      }
    }

    .checkbox-label:hover {
      background: rgba(0, 0, 0, 0.02);
      padding: 4px;
      border-radius: 4px;
      margin-left: -4px;
    }

    .checkbox-label input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .checkbox-label input[type="checkbox"]:checked {
      accent-color: #2563eb;
    }
  </style>
</head>

<body>

  <div class="container">
    <div class="header">
      <h1>Join GetContractorNow</h1>
      <p>Apply to receive exclusive HVAC leads in your service area</p>
    </div>

    <div class="form-container">
      <div id="successAlert" class="alert alert-success"></div>
      <div id="errorAlert" class="alert alert-error"></div>
      <div id="spinner" class="spinner"></div>

      <form id="applicationForm">
        <!-- Business Information -->
        <div class="section">
          <h2 class="section-title">Business Information</h2>

          <div class="form-group">
            <label>Business Name <span class="required">*</span></label>
            <input type="text" name="businessName" required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Business Type</label>
              <select name="businessType">
                <option value="">Select...</option>
                <option value="Sole Proprietor">Sole Proprietor</option>
                <option value="LLC">LLC</option>
                <option value="Corporation">Corporation</option>
                <option value="Partnership">Partnership</option>
              </select>
            </div>

            <div class="form-group">
              <label>Years in Business</label>
              <input type="number" name="yearsInBusiness" min="0" max="100">
            </div>
          </div>

          <div class="form-group">
            <label>Website URL (if applicable)</label>
            <input type="url" name="website" placeholder="https://yourcompany.com">
          </div>
        </div>

        <!-- Owner Information -->
        <div class="section">
          <h2 class="section-title">Owner/Contact Information</h2>

          <div class="form-row">
            <div class="form-group">
              <label>First Name</label>
              <input type="text" name="ownerFirstName">
            </div>

            <div class="form-group">
              <label>Last Name</label>
              <input type="text" name="ownerLastName">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Email Address <span class="required">*</span></label>
              <input type="email" name="email" required>
              <small>This will be your login email</small>
            </div>

            <div class="form-group">
              <label>Phone Number <span class="required">*</span></label>
              <input type="tel" name="phone" required placeholder="(555) 123-4567">
            </div>
          </div>
        </div>

        <!-- Business Address -->
        <div class="section">
          <h2 class="section-title">Business Address</h2>

          <div class="form-group">
            <label>Street Address</label>
            <input type="text" name="businessAddress">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>City</label>
              <input type="text" name="businessCity">
            </div>

            <div class="form-group">
              <label>State</label>
              <select name="businessState">
                <option value="">Select State...</option>
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AZ">Arizona</option>
                <option value="AR">Arkansas</option>
                <option value="CA">California</option>
                <option value="CO">Colorado</option>
                <option value="CT">Connecticut</option>
                <option value="DE">Delaware</option>
                <option value="FL">Florida</option>
                <option value="GA">Georgia</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>ZIP Code</label>
            <input type="text" name="businessZip" pattern="[0-9]{5}">
          </div>
        </div>

        <!-- License Information -->
        <div class="section">
          <h2 class="section-title">License & Credentials</h2>

          <div class="form-row">
            <div class="form-group">
              <label>License Number</label>
              <input type="text" name="licenseNumber">
            </div>

            <div class="form-group">
              <label>License State</label>
              <select name="licenseState">
                <option value="">Select State...</option>
                <option value="CA">California</option>
                <option value="TX">Texas</option>
                <option value="FL">Florida</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>License Expiration Date</label>
              <input type="date" name="licenseExpirationDate">
            </div>

            <div class="form-group">
              <label>Tax ID / EIN <span class="required">*</span></label>
              <input type="text" name="taxId" required placeholder="12-3456789" pattern="[0-9]{2}-?[0-9]{7}"
                maxlength="10">
              <small>Federal Employer Identification Number (Format: XX-XXXXXXX)</small>
            </div>
          </div>
        </div>

        <!-- Insurance Information -->
        <div class="section">
          <h2 class="section-title">Insurance Information</h2>

          <div class="form-row">
            <div class="form-group">
              <label>Insurance Provider <span class="required">*</span></label>
              <input type="text" name="insuranceProvider" required placeholder="State Farm, Allstate, etc.">
              <small>Name of your general liability insurance provider</small>
            </div>

            <div class="form-group">
              <label>Policy Number <span class="required">*</span></label>
              <input type="text" name="insurancePolicyNumber" required placeholder="POL123456789" minlength="5">
              <small>Your insurance policy number</small>
            </div>
          </div>

          <div class="form-group">
            <label>Insurance Expiration Date <span class="required">*</span></label>
            <input type="date" name="insuranceExpirationDate" required>
            <small>Policy must not be expired</small>
          </div>
        </div>

        <!-- Service Coverage -->
        <div class="section">
          <h2 class="section-title">Service Coverage</h2>

          <div class="form-group">
            <label>Service ZIP Codes <span class="required">*</span></label>
            <textarea name="serviceZipCodes" required
              placeholder="Enter ZIP codes separated by commas (e.g., 90210, 90211, 90212)"></textarea>
            <small>Enter all ZIP codes where you provide service</small>
          </div>

          <!-- ============================================ -->
          <!-- CONTRACTOR APPLICATION FORM - SERVICE TYPES -->
          <!-- Add this to your contractor-form.html -->
          <!-- ============================================ -->

          <div class="form-section">
            <h3>Services You Provide</h3>
            <p class="section-description">Select all HVAC services your company offers</p>

            <div class="form-group">
              <label>Service Types * <span style="color: #dc2626;">(Select at least one)</span></label>

              <div class="checkbox-grid"
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px; margin-top: 12px;">

                <!-- Air Conditioning Services -->
                <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                  <h4 style="margin: 0 0 10px 0; color: #1e40af; font-size: 14px; font-weight: 600;">Air Conditioning
                  </h4>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="ac_repair" style="margin-right: 8px;">
                    <span>AC Repair</span>
                  </label>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="ac_installation" style="margin-right: 8px;">
                    <span>AC Installation & Replacement</span>
                  </label>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="ac_maintenance" style="margin-right: 8px;">
                    <span>AC Maintenance & Tune-Up</span>
                  </label>
                </div>

                <!-- Heating Services -->
                <div style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                  <h4 style="margin: 0 0 10px 0; color: #92400e; font-size: 14px; font-weight: 600;">Heating</h4>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="heating_repair" style="margin-right: 8px;">
                    <span>Heating System Repair</span>
                  </label>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="furnace_repair" style="margin-right: 8px;">
                    <span>Furnace Repair</span>
                  </label>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="furnace_installation" style="margin-right: 8px;">
                    <span>Furnace Installation & Replacement</span>
                  </label>
                </div>

                <!-- HVAC & Emergency -->
                <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
                  <h4 style="margin: 0 0 10px 0; color: #065f46; font-size: 14px; font-weight: 600;">HVAC & Emergency
                  </h4>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="hvac_installation" style="margin-right: 8px;">
                    <span>Complete HVAC System Installation</span>
                  </label>

                  <label class="checkbox-label"
                    style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
                    <input type="checkbox" name="serviceTypes" value="emergency_repair" style="margin-right: 8px;">
                    <span>24/7 Emergency HVAC Repair</span>
                  </label>
                </div>

              </div>

              <div id="serviceTypesError" class="error-message"
                style="display: none; color: #dc2626; font-size: 14px; margin-top: 8px;"></div>
            </div>
          </div>

          <div class="form-group">
            <label>Additional Information</label>
            <textarea name="description"
              placeholder="Tell us about your business and why you'd like to receive exclusive leads..."></textarea>
          </div>
        </div>

        <!-- Legal Compliance -->
        <div class="section">
          <h2 class="section-title">⚖️ Legal Requirements</h2>

          <div
            style="background: #fef3c7; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #f59e0b;">
            <p style="margin: 0; color: #78350f; font-size: 0.95rem;">
              <strong>Important:</strong> Please review and accept the following to complete your application.
            </p>
          </div>

          <div class="form-group">
            <div
              style="display: flex; align-items: flex-start; gap: 10px; padding: 15px; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; margin-bottom: 15px;"
              id="termsCheckbox">
              <input type="checkbox" id="acceptedTerms" name="acceptedTerms" required
                style="width: 20px; height: 20px; margin-top: 3px; cursor: pointer;">
              <label for="acceptedTerms" style="margin: 0; cursor: pointer; font-size: 0.9rem; color: #374151;">
                I have read and agree to the <a href="/terms-of-service" target="_blank"
                  style="color: #2563eb; text-decoration: none; font-weight: 600;">Terms of Service</a> and
                <a href="/contractor-agreement" target="_blank"
                  style="color: #2563eb; text-decoration: none; font-weight: 600;">Contractor Agreement</a>.
                I understand that leads are provided on a credit-based system and I am responsible for maintaining
                sufficient credit balance. <span class="required">*</span>
              </label>
            </div>

            <div
              style="display: flex; align-items: flex-start; gap: 10px; padding: 15px; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; margin-bottom: 15px;"
              id="tcpaCheckbox">
              <input type="checkbox" id="acceptedTCPA" name="acceptedTCPA" required
                style="width: 20px; height: 20px; margin-top: 3px; cursor: pointer;">
              <label for="acceptedTCPA" style="margin: 0; cursor: pointer; font-size: 0.9rem; color: #374151;">
                <strong style="color: #1f2937;">SMS Consent (TCPA Compliance):</strong> I consent to receive automated
                SMS text messages from GetContractorNow about new lead assignments, account updates, low credit
                warnings, and service notifications. I understand that message frequency varies, message and data rates
                may apply, and I can opt out at any time by replying STOP. I can reply HELP for assistance. By providing
                my phone number, I agree to receive SMS communications as described. <span class="required">*</span>
              </label>
            </div>

            <div
              style="display: flex; align-items: flex-start; gap: 10px; padding: 15px; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; margin-bottom: 15px;"
              id="privacyCheckbox">
              <input type="checkbox" id="acceptedPrivacy" name="acceptedPrivacy" required
                style="width: 20px; height: 20px; margin-top: 3px; cursor: pointer;">
              <label for="acceptedPrivacy" style="margin: 0; cursor: pointer; font-size: 0.9rem; color: #374151;">
                I have read and understand the <a href="/privacy-policy" target="_blank"
                  style="color: #2563eb; text-decoration: none; font-weight: 600;">Privacy Policy</a>.
                I understand how my personal information will be collected, used, and protected, and I acknowledge my
                rights under GDPR and CCPA including the right to access, export, and delete my data. <span
                  class="required">*</span>
              </label>
            </div>
          </div>
        </div>

        <button type="submit" class="submit-btn">Submit Application</button>
      </form>
    </div>
  </div>

  <script>
    const API_URL = 'https://api.getcontractornow.com';

    document.getElementById('applicationForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const form = e.target;
      const submitBtn = form.querySelector('.submit-btn');
      const spinner = document.getElementById('spinner');
      const successAlert = document.getElementById('successAlert');
      const errorAlert = document.getElementById('errorAlert');

      successAlert.style.display = 'none';
      errorAlert.style.display = 'none';

      spinner.style.display = 'block';
      submitBtn.disabled = true;

      const formData = new FormData(form);
      const data = {};

      for (let [key, value] of formData.entries()) {
        if (key === 'serviceTypes') {
          if (!data.serviceTypes) {
            data.serviceTypes = [];
          }
          data.serviceTypes.push(value);
        } else {
          data[key] = value;
        }
      }

      if (!data.serviceTypes || data.serviceTypes.length < 2) {
        errorAlert.textContent = 'Please select at least 2 HVAC services offered';
        errorAlert.style.display = 'block';
        spinner.style.display = 'none';
        submitBtn.disabled = false;
        return;
      }

      const termsCheckbox = document.getElementById('acceptedTerms');
      const tcpaCheckbox = document.getElementById('acceptedTCPA');
      const privacyCheckbox = document.getElementById('acceptedPrivacy');

      if (!termsCheckbox.checked) {
        errorAlert.textContent = 'Please accept the Terms of Service to continue';
        errorAlert.style.display = 'block';
        document.getElementById('termsCheckbox').style.borderColor = '#dc2626';
        document.getElementById('termsCheckbox').style.background = '#fef2f2';
        spinner.style.display = 'none';
        submitBtn.disabled = false;
        return;
      }

      if (!tcpaCheckbox.checked) {
        errorAlert.textContent = 'Please provide SMS consent to receive lead notifications (required by TCPA)';
        errorAlert.style.display = 'block';
        document.getElementById('tcpaCheckbox').style.borderColor = '#dc2626';
        document.getElementById('tcpaCheckbox').style.background = '#fef2f2';
        spinner.style.display = 'none';
        submitBtn.disabled = false;
        return;
      }

      if (!privacyCheckbox.checked) {
        errorAlert.textContent = 'Please accept the Privacy Policy to continue';
        errorAlert.style.display = 'block';
        document.getElementById('privacyCheckbox').style.borderColor = '#dc2626';
        document.getElementById('privacyCheckbox').style.background = '#fef2f2';
        spinner.style.display = 'none';
        submitBtn.disabled = false;
        return;
      }

      document.getElementById('termsCheckbox').style.borderColor = '#e5e7eb';
      document.getElementById('termsCheckbox').style.background = '#f9fafb';
      document.getElementById('tcpaCheckbox').style.borderColor = '#e5e7eb';
      document.getElementById('tcpaCheckbox').style.background = '#f9fafb';
      document.getElementById('privacyCheckbox').style.borderColor = '#e5e7eb';
      document.getElementById('privacyCheckbox').style.background = '#f9fafb';

      data.acceptedTerms = true;
      data.acceptedTCPA = true;
      data.acceptedPrivacy = true;

      if (data.serviceZipCodes) {
        data.serviceZipCodes = data.serviceZipCodes
          .split(',')
          .map(zip => zip.trim())
          .filter(zip => zip.length > 0);
      }

      try {
        const response = await fetch(`${API_URL}/api/contractors/apply`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        const result = await response.json();

        spinner.style.display = 'none';

        if (result.success) {
          // Hide the form
          form.style.display = 'none';

          // Show enhanced success message with redirect
          successAlert.innerHTML = `
        <div style="text-align: center; padding: 40px 20px;">
          <div style="width: 80px; height: 80px; background: #10b981; border-radius: 50%; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center;">
            <svg width="50" height="50" fill="none" stroke="white" stroke-width="3" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
          <h2 style="color: #065f46; font-size: 2rem; margin-bottom: 20px;">Application Submitted Successfully!</h2>
          <p style="color: #047857; font-size: 1.1rem; margin-bottom: 15px;">${result.message}</p>
          <p style="color: #065f46; font-size: 0.95rem; margin-bottom: 10px;">
            <strong>Reference ID:</strong> ${result.applicationId}
          </p>
          <p style="color: #047857; font-size: 0.95rem; margin-bottom: 30px;">
            We'll review your application within 24-48 hours and send you login credentials.
          </p>
          <div style="background: #d1fae5; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
            <p style="color: #065f46; font-size: 1rem; margin: 0;">
              Redirecting to home page in <span id="countdown" style="font-weight: bold; font-size: 1.2rem; color: #047857;">5</span> seconds...
            </p>
          </div>
          <button onclick="window.location.href=https://www.getcontractornow.com" style="
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
          " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
            Return to Home Now
          </button>
        </div>
      `;
          successAlert.style.display = 'block';

          // Scroll to top to see success message
          window.scrollTo({ top: 0, behavior: 'smooth' });

          // Countdown and auto-redirect
          let countdown = 5;
          const countdownInterval = setInterval(() => {
            countdown--;
            const countdownEl = document.getElementById('countdown');
            if (countdownEl) {
              countdownEl.textContent = countdown;
            }

            if (countdown <= 0) {
              clearInterval(countdownInterval);
              window.location.href = 'https://www.getcontractornow.com'; // Change to your home page URL if different
            }
          }, 1000);

        } else {
          submitBtn.disabled = false;
          errorAlert.textContent = result.error || 'Failed to submit application. Please try again.';
          errorAlert.style.display = 'block';
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }

      } catch (error) {
        console.error('Submission error:', error);
        spinner.style.display = 'none';
        submitBtn.disabled = false;
        errorAlert.textContent = 'Network error. Please check your connection and try again.';
        errorAlert.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    // Validation for service types
    function validateServiceTypes() {
      const checkboxes = document.querySelectorAll('input[name="serviceTypes"]:checked');
      const errorDiv = document.getElementById('serviceTypesError');

      if (checkboxes.length === 0) {
        errorDiv.textContent = 'Please select at least one service type';
        errorDiv.style.display = 'block';
        return false;
      }

      errorDiv.style.display = 'none';
      return true;
    }

    // Get selected service types
    function getSelectedServiceTypes() {
      const checkboxes = document.querySelectorAll('input[name="serviceTypes"]:checked');
      return Array.from(checkboxes).map(cb => cb.value);
    }
  </script>
</body>

</html>